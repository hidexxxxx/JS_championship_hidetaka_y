<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="mypage.css">
    <title>spotlight × Cloud Garage</title>
</head>

<body>
    <header id="header">
        <div class="logo-box">
            <a href="mypage.css"><img class="brand-logo" src="xxx" alt="logo"></a>
        </div>
        <nav class="wrapper">
            <ul class="menu">
                <li class="menu-all"><a href="#">MY PAGE</a></li>
                <li class="menu-category"><a href="#">CATEGORY</a></li>
            </ul>
            <ul class="login">
                <li class="menu-resister"><a onclick="location.href='resister.html';">PROFILE</a></li>
                <li class="login-login"><a onclick="location.href='login.html';">LOGIN</a></li>
                <li class="login-contact"><a href="#">CONTACT</a></li>
            </ul>
        </nav>

        <ul id="output"></ul>

    </header>

    </script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script type="module">
        //▼以下firestore databaseへのテキストデータアップロード
        import {
            initializeApp
        }
            from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";

        import {
            getFirestore,
            collection,
            addDoc,
            serverTimestamp,
            query,
            orderBy,
            onSnapshot,
        } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDADUT7tlyvD8G-WfBpVQoUaY6fRxvvug8",
            authDomain: "jschampionship-f5265.firebaseapp.com",
            projectId: "jschampionship-f5265",
            storageBucket: "jschampionship-f5265.appspot.com",
            messagingSenderId: "171502542751",
            appId: "1:171502542751:web:0e4129428f53af19ce67aa"
        };

        // Firebase App を初期化して連携させる
        const app = initializeApp(firebaseConfig);
        //firestoreのオブジェクトを取得
        const db = getFirestore(app);

        $("#save").on("click", function () {
            // 送信時に必要な処理。

            const postData = {
                name: $("#input-name").val(),
                birth: $("#input-birth").val(),
                comment: $("#input-commit").val(),
                time: serverTimestamp(),
            };

            addDoc(collection(db, "user"), postData);
        });

        //データ取得処理

        const q = query(collection(db, "user"), orderBy("time", "desc"));

        onSnapshot(q, (querySnapshot) => {
            console.log(querySnapshot.docs);

            //複雑な形のため必要なデータのみ抽出した「オブジェクト形式の配列」に変換
            const documents = [];
            querySnapshot.forEach((doc) => {
                console.log(doc.data());
                const document = {
                    id: doc.id,
                    data: doc.data(),
                };
                documents.push(document);
            });

            const htmlElements = [];
            documents.forEach(function (document) {
                htmlElements.push(`
                            <li id="${documents[0].id}">
                                <p>Name: ${documents[0].data.name}</p>
                                <p>Birth: ${documents[0].data.birth}</p>
                                <p>Comment: ${documents[0].data.comment}</p>
                            </li>
                        `);
            });

            $("#output").html(htmlElements[0]);
        });

    </script>




    <main>







    </main>

</body>
<footer>
    <nav class="wrapper-footer">
        <ul class="menu-footer">
            <li><a href="#">初めての方へ</a></li>
            <li><a href="#">よくある質問</a></li>
            <li><a href="#">利用規約</a></li>
            <li><a href="#">特定商品取引法</a></li>
            <li><a href="#">プライバシーポリシー</a></li>
            <li><a href="#">お問い合わせ</a></li>
            <li><a href="#">会社概要</a></li>
        </ul>
    </nav>
    <h5 class="copy-rights">©️2023 Cloud Garage Co,.Ltd. All Rights Reserved</h5>
</footer>


</html>